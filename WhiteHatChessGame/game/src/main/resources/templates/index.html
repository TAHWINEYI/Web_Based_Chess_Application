<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Chess Game</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Main centered container */
        .main-container {
            max-width: 1800px;
            margin: 3rem 5rem;
            padding: 2rem;
            height: calc(100vh - 6rem);
            display: flex;
            flex-direction: column;
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.1);
        }

        /* Chess board styling - Maximized */
        .chess-board-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .chess-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(8, 1fr);
            aspect-ratio: 1/1;
            width: 100%;
            height: 100%;
            max-height: calc(100vh - 15rem);
            margin: 0 auto;
        }

        .chess-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(48px, 8vw, 84px);
        }

        .white-cell { background-color: #f0d9b5; }
        .black-cell { background-color: #b58863; }

        /* Title styling */
        .game-title {
            margin-bottom: 2rem;
            margin-top: 1rem;
        }

        /* Form controls */
        .form-control-sm {
            height: calc(1.8em + 0.75rem);
            padding: 0.375rem 0.5rem;
            font-size: 0.875rem;
        }

        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }

        /* Layout adjustments */
        .compact-card {
            margin-bottom: 1rem;
        }

        .compact-card .card-body {
            padding: 1rem;
        }

        .compact-title {
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .status-message {
            font-size: 0.9rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .controls-container {
            margin-top: 1rem;
        }

        .action-buttons {
            margin-top: 1rem;
        }

        /* Stylish Footer */
        .stylish-footer {
            margin-top: auto;
            text-align: center;
            padding: 1rem;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #6c757d;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
        }

        .stylish-footer span {
            color: #0d6efd;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        @media (max-width: 1400px) {
            .main-container {
                margin: 3rem;
            }
            .chess-cell {
                font-size: clamp(40px, 7vw, 72px);
            }
        }

        @media (max-width: 992px) {
            .main-container {
                margin: 2rem;
                padding: 1.5rem;
                height: auto;
                min-height: calc(100vh - 4rem);
            }
            .chess-board {
                max-height: 90vw;
            }
            .game-title {
                margin-bottom: 1.5rem;
            }
            .stylish-footer {
                padding: 0.75rem;
            }
        }
    </style>
</head>
<body class="bg-light">
<div class="main-container">
    <!-- Header with increased margin -->
    <div class="row game-title">
        <div class="col-12 text-center">
            <h1 class="h4 fw-bold mb-0">
                <i class="fas fa-chess me-2"></i>White Hat Chess Game<i class="fas fa-chess-king ms-2"></i>
            </h1>
        </div>
    </div>

    <!-- Main Content -->
    <div class="row flex-grow-1 g-3">
        <!-- Left Column - Chess Board (75% width) -->
        <div class="col-lg-9 d-flex flex-column p-0">
            <div class="chess-board-container">
                <div id="statusMessage" class="status-message alert alert-info text-center"
                     th:text="${board?.statusMessage}">White's turn</div>

                <div class="chess-board">
                    <div class="chess-row" th:each="row : ${board?.emojiGrid}">
                        <div class="chess-cell"
                             th:each="cell, colStat : ${row}"
                             th:data-x="${colStat.index}"
                             th:data-y="${rowStat.index}"
                             th:class="${(rowStat.index + colStat.index) % 2 == 0 ? 'white-cell' : 'black-cell'}">
                            <span th:text="${cell}"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column - Controls (25% width) -->
        <div class="col-lg-3 d-flex flex-column controls-container">
            <!-- Move Form -->
            <div class="card compact-card">
                <div class="card-body">
                    <h5 class="compact-title">Make Move</h5>
                    <form id="moveForm" action="/api/v1/chess/move" method="post">
                        <div class="input-group mb-2">
                            <input type="text" id="moveInput" name="move"
                                   class="form-control form-control-sm"
                                   placeholder="e.g. e2e4"
                                   pattern="[a-h][1-8][a-h][1-8]"
                                   required>
                            <button type="submit" class="btn btn-primary btn-sm">
                                <i class="fas fa-paper-plane me-1"></i>Move
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- File Upload -->
            <div class="card compact-card">
                <div class="card-body">
                    <h5 class="compact-title">Load Moves</h5>
                    <form id="loadFileForm" action="/api/v1/chess/load-file" method="post" enctype="multipart/form-data">
                        <div class="mb-2">
                            <input type="file" class="form-control form-control-sm"
                                   id="chessFile" name="file" accept=".txt,.csv">
                        </div>
                        <button type="submit" class="btn btn-success btn-sm w-100">
                            <i class="fas fa-upload me-1"></i>Upload
                        </button>
                    </form>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <div class="d-flex justify-content-between g-2">
                    <form action="/api/v1/chess/reset" method="post" class="me-2">
                        <button type="submit" class="btn btn-danger btn-sm w-100">
                            <i class="fas fa-redo me-1"></i>Reset
                        </button>
                    </form>
                    <button class="btn btn-outline-primary btn-sm flex-grow-1"
                            data-bs-toggle="modal" data-bs-target="#helpModal">
                        <i class="fas fa-question me-1"></i>Help
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Stylish Footer -->
    <div class="stylish-footer">
        Crafted with ♥ by <span>Lisbon Tahwineyi</span> | Where strategy meets elegance
    </div>
</div>

<!-- Help Modal -->
<div class="modal fade" id="helpModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white py-2">
                <h5 class="modal-title h6"><i class="fas fa-chess-board me-1"></i>Chess Help</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-2">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="fw-bold">Pieces:</h6>
                        <div class="mb-2">
                            <div>♖♘♗♕♔♙ White</div>
                            <div>♜♞♝♛♚♟ Black</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6 class="fw-bold">Move Examples:</h6>
                        <div class="bg-light p-2 rounded">
                            <code>e2e4</code><br>
                            <code>g1f3</code><br>
                            <code>a7a8q</code>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer py-2">
                <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>